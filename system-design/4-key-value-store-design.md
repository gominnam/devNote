## 키-값 저장소 설계


### 1. Key-Value Store (키-값 저장소)

- Key-Value
: 키-값 저장소는 키-값 데이터베이스라고도 불리는 비 관계형 데이터베이스이다.
: 키-값 쌍에서의 키는 `유일`해야 하며 해당 키에 연결된 값은 키를 통해서만 접근할 수 있다.
: 명령어 - put(key, value), get(key)
: ex) Amazon DynamoDB, memcached, Redis 등..




### 2. 분산 키-값 저장소

- 분산 키-값 저장소는 **분산 해시 테이블**이라고도 불린다.
: **해시 테이블**은 **키-값 쌍**을 저장하는 자료구조이다.


### 3. CAP 정리

- CAP (Consistency, Availability, Partition Tolerance)
: **일관성(Consistency)** : 모든 노드가 동일한 데이터를 보는 것
: **가용성(Availability)** : 모든 요청에 대한 응답을 보장하는 것
: **분할 내성(Partition Tolerance)** : 네트워크 분할이 발생해도 시스템이 정상 동작하는 것
: 일관성과 가용성을 함께 지원하는 CA 시스템은 실세계에 존재하지 않는다.
: => 실세계의 분산 시스템은 **CP** 또는 **AP** 중 하나를 선택해야 한다.



### 4. 시스템 컴포넌트

- 데이터 파티션 
: Problem : 대규모 애플리케이션의 경우 한대 서버에 데이터를 저장하는 것은 불가능하다.
: 해결을 위해 고려해야할 점 
: - 데이터를 여러 서버에 고르게 분산하기
: - 노드가 추가, 삭제될 때 데이터의 이동을 최소화 할 수 있는가
: => **Consistent Hashing**(안정 해시)을 사용하여 해결한다.

- 데이터 다중화
: 높은 가용성과 안정성을 확보하기 위해 데이터를 N개의 서버에 비동기적으로 다중화
: 안정성을 담보하기 위해 데이터의 사본을 다른 센터에 보관하고, 센터들은 고속 네트워크로 연결한다.

- 데이터 일관성
: 일관성 모델 
: - **Strong Consistency** : 모든 노드가 동일한 데이터를 보는 것(낡은 데이터를 보지 않는다)
: - **Weak Consistency** : 읽기 연산은 가장 최근에 갱신된 결과를 반환하지 못할 수 있다.
: - **Eventual Consistency** : 약한 일관성의 한 형태로, 시간이 지난 후에는 모든 노드가 동일한 데이터를 보게 된다.



### 5. 비 일관성 해소 기법

- 데이터 버저닝
: 버저닝은 데이터를 변경할 때마다 해당 데이터의 새로운 버전을 만드는 것을 의미한다.
: 벡터 시계는 [서버, 버전]의 순서쌍을 데이터에 매단 것이다.
: - 어떤 버전이 선행 버전인지, 후행 버전인지, 충돌이 있는지 판별하는데 쓰임



